"0","set.seed(7*11*13)  # My public seed"
"0","X <- data.frame(x1=rnorm(200, 20, sd=3),"
"0","                x2=factor(rep(1:3, c(100, 50, 50))),"
"0","                y=rbinom(200, 1, 0.25))"
"0",""
"0","N <- 10000 # Simulating the null distribution"
"0",""
"0","sim_dev <- function(N) {"
"0","    res <- numeric(N)"
"0","    for (i in seq_along(res)) {"
"0","        X$y <- rbinom(200, 1, 0.25)"
"0","        mod <- glm(y  ~ x1+x2, data=X, family=binomial)"
"0","        res[i] <- with(mod,  null.deviance-deviance)"
"0","    }"
"0","    res"
"0","}"
"0",""
"0","deviance <- sim_dev(N)"
"0",""
"0","mean(deviance); var(deviance)"
"1","[1]"
"1"," 3.016633"
"1","
"
"1","[1]"
"1"," 6.090653"
"1","
"
"0"," 3.016633"
"1","[1]"
"1"," 3.016633"
"1","
"
"0"," 6.090653  # Rather close to theoretical values 3, 6"
"1","[1]"
"1"," 6.090653"
"1","
"
"0","hist(deviance, prob=TRUE, breaks=""FD"")"
